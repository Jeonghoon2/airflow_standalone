[2024-07-31T15:30:12.087+0900] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-31T15:30:12.098+0900] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: movie.nation.k scheduled__2024-07-30T02:10:00+00:00 [queued]>
[2024-07-31T15:30:12.100+0900] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: movie.nation.k scheduled__2024-07-30T02:10:00+00:00 [queued]>
[2024-07-31T15:30:12.101+0900] {taskinstance.py:2306} INFO - Starting attempt 3 of 4
[2024-07-31T15:30:12.106+0900] {taskinstance.py:2330} INFO - Executing <Task(PythonVirtualenvOperator): nation.k> on 2024-07-30 02:10:00+00:00
[2024-07-31T15:30:12.110+0900] {standard_task_runner.py:64} INFO - Started process 17069 to run task
[2024-07-31T15:30:12.112+0900] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'movie', 'nation.k', 'scheduled__2024-07-30T02:10:00+00:00', '--job-id', '785', '--raw', '--subdir', 'DAGS_FOLDER/movie.py', '--cfg-path', '/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/tmp4b7hw3p0']
[2024-07-31T15:30:12.114+0900] {standard_task_runner.py:91} INFO - Job 785: Subtask nation.k
[2024-07-31T15:30:12.130+0900] {task_command.py:426} INFO - Running <TaskInstance: movie.nation.k scheduled__2024-07-30T02:10:00+00:00 [running]> on host jeongui-MacBookPro.local
[2024-07-31T15:30:12.151+0900] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='movie' AIRFLOW_CTX_TASK_ID='nation.k' AIRFLOW_CTX_EXECUTION_DATE='2024-07-30T02:10:00+00:00' AIRFLOW_CTX_TRY_NUMBER='3' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-30T02:10:00+00:00'
[2024-07-31T15:30:12.152+0900] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-31T15:30:12.159+0900] {baseoperator.py:400} WARNING - PythonVirtualenvOperator.execute cannot be called outside TaskInstance!
[2024-07-31T15:30:12.159+0900] {process_utils.py:183} INFO - Executing cmd: /Users/DE32/.pyenv/versions/3.11.9/envs/note/bin/python -m virtualenv /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty --python=python
[2024-07-31T15:30:12.161+0900] {process_utils.py:187} INFO - Output:
[2024-07-31T15:30:12.425+0900] {process_utils.py:191} INFO - created virtual environment CPython3.11.9.final.0-64 in 194ms
[2024-07-31T15:30:12.426+0900] {process_utils.py:191} INFO -   creator CPython3Posix(dest=/private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty, clear=False, no_vcs_ignore=False, global=False)
[2024-07-31T15:30:12.426+0900] {process_utils.py:191} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/Users/DE32/Library/Application Support/virtualenv)
[2024-07-31T15:30:12.426+0900] {process_utils.py:191} INFO -     added seed packages: pip==24.1.2, setuptools==70.2.0, wheel==0.43.0
[2024-07-31T15:30:12.426+0900] {process_utils.py:191} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2024-07-31T15:30:12.441+0900] {process_utils.py:183} INFO - Executing cmd: /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/bin/pip install -r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt
[2024-07-31T15:30:12.443+0900] {process_utils.py:187} INFO - Output:
[2024-07-31T15:30:13.272+0900] {process_utils.py:191} INFO - Collecting git+https://github.com/Jeonghoon2/movie.git@0.2/api (from -r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:13.273+0900] {process_utils.py:191} INFO -   Cloning https://github.com/Jeonghoon2/movie.git (to revision 0.2/api) to /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-req-build-w2kwrl2k
[2024-07-31T15:30:13.286+0900] {process_utils.py:191} INFO -   Running command git clone --filter=blob:none --quiet https://github.com/Jeonghoon2/movie.git /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-req-build-w2kwrl2k
[2024-07-31T15:30:14.781+0900] {process_utils.py:191} INFO -   Running command git checkout -b 0.2/api --track origin/0.2/api
[2024-07-31T15:30:15.291+0900] {process_utils.py:191} INFO -   Switched to a new branch '0.2/api'
[2024-07-31T15:30:15.291+0900] {process_utils.py:191} INFO -   branch '0.2/api' set up to track 'origin/0.2/api'.
[2024-07-31T15:30:15.292+0900] {process_utils.py:191} INFO -   Resolved https://github.com/Jeonghoon2/movie.git to commit 34de3b5e993ea074744539373447116355ac95da
[2024-07-31T15:30:15.317+0900] {process_utils.py:191} INFO -   Installing build dependencies: started
[2024-07-31T15:30:16.253+0900] {process_utils.py:191} INFO -   Installing build dependencies: finished with status 'done'
[2024-07-31T15:30:16.254+0900] {process_utils.py:191} INFO -   Getting requirements to build wheel: started
[2024-07-31T15:30:16.380+0900] {process_utils.py:191} INFO -   Getting requirements to build wheel: finished with status 'done'
[2024-07-31T15:30:16.382+0900] {process_utils.py:191} INFO -   Preparing metadata (pyproject.toml): started
[2024-07-31T15:30:16.507+0900] {process_utils.py:191} INFO -   Preparing metadata (pyproject.toml): finished with status 'done'
[2024-07-31T15:30:16.590+0900] {process_utils.py:191} INFO - Collecting requests>=2.32.3 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.592+0900] {process_utils.py:191} INFO -   Using cached requests-2.32.3-py3-none-any.whl.metadata (4.6 kB)
[2024-07-31T15:30:16.658+0900] {process_utils.py:191} INFO - Collecting pandas>=2.2.2 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.659+0900] {process_utils.py:191} INFO -   Using cached pandas-2.2.2-cp311-cp311-macosx_11_0_arm64.whl.metadata (19 kB)
[2024-07-31T15:30:16.762+0900] {process_utils.py:191} INFO - Collecting numpy>=2.0.1 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.764+0900] {process_utils.py:191} INFO -   Using cached numpy-2.0.1-cp311-cp311-macosx_14_0_arm64.whl.metadata (60 kB)
[2024-07-31T15:30:16.821+0900] {process_utils.py:191} INFO - Collecting pyarrow>=17.0.0 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.823+0900] {process_utils.py:191} INFO -   Using cached pyarrow-17.0.0-cp311-cp311-macosx_11_0_arm64.whl.metadata (3.3 kB)
[2024-07-31T15:30:16.848+0900] {process_utils.py:191} INFO - Collecting python-dateutil>=2.8.2 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.848+0900] {process_utils.py:191} INFO -   Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)
[2024-07-31T15:30:16.881+0900] {process_utils.py:191} INFO - Collecting pytz>=2020.1 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.882+0900] {process_utils.py:191} INFO -   Using cached pytz-2024.1-py2.py3-none-any.whl.metadata (22 kB)
[2024-07-31T15:30:16.906+0900] {process_utils.py:191} INFO - Collecting tzdata>=2022.7 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.907+0900] {process_utils.py:191} INFO -   Using cached tzdata-2024.1-py2.py3-none-any.whl.metadata (1.4 kB)
[2024-07-31T15:30:16.953+0900] {process_utils.py:191} INFO - Collecting charset-normalizer<4,>=2 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.954+0900] {process_utils.py:191} INFO -   Using cached charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl.metadata (33 kB)
[2024-07-31T15:30:16.969+0900] {process_utils.py:191} INFO - Collecting idna<4,>=2.5 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:16.970+0900] {process_utils.py:191} INFO -   Using cached idna-3.7-py3-none-any.whl.metadata (9.9 kB)
[2024-07-31T15:30:17.001+0900] {process_utils.py:191} INFO - Collecting urllib3<3,>=1.21.1 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:17.002+0900] {process_utils.py:191} INFO -   Using cached urllib3-2.2.2-py3-none-any.whl.metadata (6.4 kB)
[2024-07-31T15:30:17.026+0900] {process_utils.py:191} INFO - Collecting certifi>=2017.4.17 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:17.027+0900] {process_utils.py:191} INFO -   Using cached certifi-2024.7.4-py3-none-any.whl.metadata (2.2 kB)
[2024-07-31T15:30:17.060+0900] {process_utils.py:191} INFO - Collecting six>=1.5 (from python-dateutil>=2.8.2->pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/requirements.txt (line 1))
[2024-07-31T15:30:17.061+0900] {process_utils.py:191} INFO -   Using cached six-1.16.0-py2.py3-none-any.whl.metadata (1.8 kB)
[2024-07-31T15:30:17.064+0900] {process_utils.py:191} INFO - Using cached numpy-2.0.1-cp311-cp311-macosx_14_0_arm64.whl (5.3 MB)
[2024-07-31T15:30:17.073+0900] {process_utils.py:191} INFO - Using cached pandas-2.2.2-cp311-cp311-macosx_11_0_arm64.whl (11.3 MB)
[2024-07-31T15:30:17.090+0900] {process_utils.py:191} INFO - Using cached pyarrow-17.0.0-cp311-cp311-macosx_11_0_arm64.whl (27.2 MB)
[2024-07-31T15:30:17.122+0900] {process_utils.py:191} INFO - Using cached requests-2.32.3-py3-none-any.whl (64 kB)
[2024-07-31T15:30:17.126+0900] {process_utils.py:191} INFO - Using cached certifi-2024.7.4-py3-none-any.whl (162 kB)
[2024-07-31T15:30:17.128+0900] {process_utils.py:191} INFO - Using cached charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl (118 kB)
[2024-07-31T15:30:17.130+0900] {process_utils.py:191} INFO - Using cached idna-3.7-py3-none-any.whl (66 kB)
[2024-07-31T15:30:17.132+0900] {process_utils.py:191} INFO - Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
[2024-07-31T15:30:17.134+0900] {process_utils.py:191} INFO - Using cached pytz-2024.1-py2.py3-none-any.whl (505 kB)
[2024-07-31T15:30:17.137+0900] {process_utils.py:191} INFO - Using cached tzdata-2024.1-py2.py3-none-any.whl (345 kB)
[2024-07-31T15:30:17.139+0900] {process_utils.py:191} INFO - Using cached urllib3-2.2.2-py3-none-any.whl (121 kB)
[2024-07-31T15:30:17.141+0900] {process_utils.py:191} INFO - Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
[2024-07-31T15:30:17.184+0900] {process_utils.py:191} INFO - Building wheels for collected packages: mov
[2024-07-31T15:30:17.197+0900] {process_utils.py:191} INFO -   Building wheel for mov (pyproject.toml): started
[2024-07-31T15:30:17.346+0900] {process_utils.py:191} INFO -   Building wheel for mov (pyproject.toml): finished with status 'done'
[2024-07-31T15:30:17.347+0900] {process_utils.py:191} INFO -   Created wheel for mov: filename=mov-0.1.0-py3-none-any.whl size=3035 sha256=2db3d5820edda4d66ccc30625ccf52b82285c6342b473e8267740d596ab5b687
[2024-07-31T15:30:17.348+0900] {process_utils.py:191} INFO -   Stored in directory: /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-ephem-wheel-cache-2mcy772i/wheels/cf/ab/a7/d0c528d20fa8a5f19e169bdf1d98f2b2cefe79d8527bb89200
[2024-07-31T15:30:17.349+0900] {process_utils.py:191} INFO - Successfully built mov
[2024-07-31T15:30:17.396+0900] {process_utils.py:191} INFO - Installing collected packages: pytz, urllib3, tzdata, six, numpy, idna, charset-normalizer, certifi, requests, python-dateutil, pyarrow, pandas, mov
[2024-07-31T15:30:21.966+0900] {process_utils.py:191} INFO - Successfully installed certifi-2024.7.4 charset-normalizer-3.3.2 idna-3.7 mov-0.1.0 numpy-2.0.1 pandas-2.2.2 pyarrow-17.0.0 python-dateutil-2.9.0.post0 pytz-2024.1 requests-2.32.3 six-1.16.0 tzdata-2024.1 urllib3-2.2.2
[2024-07-31T15:30:21.970+0900] {process_utils.py:191} INFO - 
[2024-07-31T15:30:21.970+0900] {process_utils.py:191} INFO - [notice] A new release of pip is available: 24.1.2 -> 24.2
[2024-07-31T15:30:21.970+0900] {process_utils.py:191} INFO - [notice] To update, run: python -m pip install --upgrade pip
[2024-07-31T15:30:22.105+0900] {process_utils.py:183} INFO - Executing cmd: /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvabnn57ty/bin/python /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callm6pgpigq/script.py /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callm6pgpigq/script.in /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callm6pgpigq/script.out /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callm6pgpigq/string_args.txt /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callm6pgpigq/termination.log
[2024-07-31T15:30:22.107+0900] {process_utils.py:187} INFO - Output:
[2024-07-31T15:30:22.120+0900] {process_utils.py:191} INFO - Traceback (most recent call last):
[2024-07-31T15:30:22.121+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callm6pgpigq/script.py", line 58, in <module>
[2024-07-31T15:30:22.121+0900] {process_utils.py:191} INFO -     res = get_data_with_params(*arg_dict["args"], **arg_dict["kwargs"])
[2024-07-31T15:30:22.121+0900] {process_utils.py:191} INFO -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-07-31T15:30:22.121+0900] {process_utils.py:191} INFO - TypeError: get_data_with_params() missing 1 required positional argument: 'params'
[2024-07-31T15:30:22.555+0900] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-31T15:30:22.558+0900] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 437, in execute
    return super().execute(context=serializable_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 759, in execute_callable
    result = self._execute_python_callable_in_subprocess(python_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 514, in _execute_python_callable_in_subprocess
    raise AirflowException(error_msg) from None
airflow.exceptions.AirflowException: Process returned non-zero exit status 1.
get_data_with_params() missing 1 required positional argument: 'params'
[2024-07-31T15:30:22.561+0900] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=movie, task_id=nation.k, run_id=scheduled__2024-07-30T02:10:00+00:00, execution_date=20240730T021000, start_date=20240731T063012, end_date=20240731T063022
[2024-07-31T15:30:22.565+0900] {standard_task_runner.py:110} ERROR - Failed to execute job 785 for task nation.k (Process returned non-zero exit status 1.
get_data_with_params() missing 1 required positional argument: 'params'; 17069)
[2024-07-31T15:30:22.593+0900] {local_task_job_runner.py:243} INFO - Task exited with return code 1
[2024-07-31T15:30:22.600+0900] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-31T15:30:22.602+0900] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-31T17:51:52.308+0900] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-31T17:51:52.318+0900] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: movie.nation.k scheduled__2024-07-30T02:10:00+00:00 [queued]>
[2024-07-31T17:51:52.322+0900] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: movie.nation.k scheduled__2024-07-30T02:10:00+00:00 [queued]>
[2024-07-31T17:51:52.322+0900] {taskinstance.py:2306} INFO - Starting attempt 3 of 4
[2024-07-31T17:51:52.329+0900] {taskinstance.py:2330} INFO - Executing <Task(PythonVirtualenvOperator): nation.k> on 2024-07-30 02:10:00+00:00
[2024-07-31T17:51:52.332+0900] {standard_task_runner.py:64} INFO - Started process 24118 to run task
[2024-07-31T17:51:52.334+0900] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'movie', 'nation.k', 'scheduled__2024-07-30T02:10:00+00:00', '--job-id', '896', '--raw', '--subdir', 'DAGS_FOLDER/movie.py', '--cfg-path', '/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/tmp77u6nrgf']
[2024-07-31T17:51:52.335+0900] {standard_task_runner.py:91} INFO - Job 896: Subtask nation.k
[2024-07-31T17:51:52.350+0900] {task_command.py:426} INFO - Running <TaskInstance: movie.nation.k scheduled__2024-07-30T02:10:00+00:00 [running]> on host jeongui-MacBookPro.local
[2024-07-31T17:51:52.379+0900] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='movie' AIRFLOW_CTX_TASK_ID='nation.k' AIRFLOW_CTX_EXECUTION_DATE='2024-07-30T02:10:00+00:00' AIRFLOW_CTX_TRY_NUMBER='3' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-30T02:10:00+00:00'
[2024-07-31T17:51:52.380+0900] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-31T17:51:52.388+0900] {baseoperator.py:400} WARNING - PythonVirtualenvOperator.execute cannot be called outside TaskInstance!
[2024-07-31T17:51:52.388+0900] {process_utils.py:183} INFO - Executing cmd: /Users/DE32/.pyenv/versions/3.11.9/envs/note/bin/python -m virtualenv /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q --python=python
[2024-07-31T17:51:52.391+0900] {process_utils.py:187} INFO - Output:
[2024-07-31T17:51:52.679+0900] {process_utils.py:191} INFO - created virtual environment CPython3.11.9.final.0-64 in 206ms
[2024-07-31T17:51:52.679+0900] {process_utils.py:191} INFO -   creator CPython3Posix(dest=/private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q, clear=False, no_vcs_ignore=False, global=False)
[2024-07-31T17:51:52.679+0900] {process_utils.py:191} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/Users/DE32/Library/Application Support/virtualenv)
[2024-07-31T17:51:52.680+0900] {process_utils.py:191} INFO -     added seed packages: pip==24.1.2, setuptools==70.2.0, wheel==0.43.0
[2024-07-31T17:51:52.680+0900] {process_utils.py:191} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2024-07-31T17:51:52.691+0900] {process_utils.py:183} INFO - Executing cmd: /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/bin/pip install -r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt
[2024-07-31T17:51:52.693+0900] {process_utils.py:187} INFO - Output:
[2024-07-31T17:51:53.483+0900] {process_utils.py:191} INFO - Collecting git+https://github.com/Jeonghoon2/movie.git@0.2/api (from -r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:53.484+0900] {process_utils.py:191} INFO -   Cloning https://github.com/Jeonghoon2/movie.git (to revision 0.2/api) to /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-req-build-x12aadgt
[2024-07-31T17:51:53.499+0900] {process_utils.py:191} INFO -   Running command git clone --filter=blob:none --quiet https://github.com/Jeonghoon2/movie.git /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-req-build-x12aadgt
[2024-07-31T17:51:54.977+0900] {process_utils.py:191} INFO -   Running command git checkout -b 0.2/api --track origin/0.2/api
[2024-07-31T17:51:55.556+0900] {process_utils.py:191} INFO -   Switched to a new branch '0.2/api'
[2024-07-31T17:51:55.557+0900] {process_utils.py:191} INFO -   branch '0.2/api' set up to track 'origin/0.2/api'.
[2024-07-31T17:51:55.557+0900] {process_utils.py:191} INFO -   Resolved https://github.com/Jeonghoon2/movie.git to commit 3e0a21e3e155d637ca26fdd452be387e0f4ca3e9
[2024-07-31T17:51:55.575+0900] {process_utils.py:191} INFO -   Installing build dependencies: started
[2024-07-31T17:51:56.496+0900] {process_utils.py:191} INFO -   Installing build dependencies: finished with status 'done'
[2024-07-31T17:51:56.497+0900] {process_utils.py:191} INFO -   Getting requirements to build wheel: started
[2024-07-31T17:51:56.629+0900] {process_utils.py:191} INFO -   Getting requirements to build wheel: finished with status 'done'
[2024-07-31T17:51:56.631+0900] {process_utils.py:191} INFO -   Preparing metadata (pyproject.toml): started
[2024-07-31T17:51:56.760+0900] {process_utils.py:191} INFO -   Preparing metadata (pyproject.toml): finished with status 'done'
[2024-07-31T17:51:56.811+0900] {process_utils.py:191} INFO - Collecting requests>=2.32.3 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:56.812+0900] {process_utils.py:191} INFO -   Using cached requests-2.32.3-py3-none-any.whl.metadata (4.6 kB)
[2024-07-31T17:51:56.886+0900] {process_utils.py:191} INFO - Collecting pandas>=2.2.2 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:56.888+0900] {process_utils.py:191} INFO -   Using cached pandas-2.2.2-cp311-cp311-macosx_11_0_arm64.whl.metadata (19 kB)
[2024-07-31T17:51:56.988+0900] {process_utils.py:191} INFO - Collecting numpy>=2.0.1 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:56.990+0900] {process_utils.py:191} INFO -   Using cached numpy-2.0.1-cp311-cp311-macosx_14_0_arm64.whl.metadata (60 kB)
[2024-07-31T17:51:57.040+0900] {process_utils.py:191} INFO - Collecting pyarrow>=17.0.0 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.041+0900] {process_utils.py:191} INFO -   Using cached pyarrow-17.0.0-cp311-cp311-macosx_11_0_arm64.whl.metadata (3.3 kB)
[2024-07-31T17:51:57.060+0900] {process_utils.py:191} INFO - Collecting python-dateutil>=2.8.2 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.061+0900] {process_utils.py:191} INFO -   Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)
[2024-07-31T17:51:57.092+0900] {process_utils.py:191} INFO - Collecting pytz>=2020.1 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.093+0900] {process_utils.py:191} INFO -   Using cached pytz-2024.1-py2.py3-none-any.whl.metadata (22 kB)
[2024-07-31T17:51:57.107+0900] {process_utils.py:191} INFO - Collecting tzdata>=2022.7 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.108+0900] {process_utils.py:191} INFO -   Using cached tzdata-2024.1-py2.py3-none-any.whl.metadata (1.4 kB)
[2024-07-31T17:51:57.153+0900] {process_utils.py:191} INFO - Collecting charset-normalizer<4,>=2 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.154+0900] {process_utils.py:191} INFO -   Using cached charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl.metadata (33 kB)
[2024-07-31T17:51:57.168+0900] {process_utils.py:191} INFO - Collecting idna<4,>=2.5 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.169+0900] {process_utils.py:191} INFO -   Using cached idna-3.7-py3-none-any.whl.metadata (9.9 kB)
[2024-07-31T17:51:57.198+0900] {process_utils.py:191} INFO - Collecting urllib3<3,>=1.21.1 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.199+0900] {process_utils.py:191} INFO -   Using cached urllib3-2.2.2-py3-none-any.whl.metadata (6.4 kB)
[2024-07-31T17:51:57.216+0900] {process_utils.py:191} INFO - Collecting certifi>=2017.4.17 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.217+0900] {process_utils.py:191} INFO -   Using cached certifi-2024.7.4-py3-none-any.whl.metadata (2.2 kB)
[2024-07-31T17:51:57.242+0900] {process_utils.py:191} INFO - Collecting six>=1.5 (from python-dateutil>=2.8.2->pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/requirements.txt (line 1))
[2024-07-31T17:51:57.244+0900] {process_utils.py:191} INFO -   Using cached six-1.16.0-py2.py3-none-any.whl.metadata (1.8 kB)
[2024-07-31T17:51:57.247+0900] {process_utils.py:191} INFO - Using cached numpy-2.0.1-cp311-cp311-macosx_14_0_arm64.whl (5.3 MB)
[2024-07-31T17:51:57.255+0900] {process_utils.py:191} INFO - Using cached pandas-2.2.2-cp311-cp311-macosx_11_0_arm64.whl (11.3 MB)
[2024-07-31T17:51:57.271+0900] {process_utils.py:191} INFO - Using cached pyarrow-17.0.0-cp311-cp311-macosx_11_0_arm64.whl (27.2 MB)
[2024-07-31T17:51:57.304+0900] {process_utils.py:191} INFO - Using cached requests-2.32.3-py3-none-any.whl (64 kB)
[2024-07-31T17:51:57.307+0900] {process_utils.py:191} INFO - Using cached certifi-2024.7.4-py3-none-any.whl (162 kB)
[2024-07-31T17:51:57.309+0900] {process_utils.py:191} INFO - Using cached charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl (118 kB)
[2024-07-31T17:51:57.311+0900] {process_utils.py:191} INFO - Using cached idna-3.7-py3-none-any.whl (66 kB)
[2024-07-31T17:51:57.314+0900] {process_utils.py:191} INFO - Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
[2024-07-31T17:51:57.317+0900] {process_utils.py:191} INFO - Using cached pytz-2024.1-py2.py3-none-any.whl (505 kB)
[2024-07-31T17:51:57.319+0900] {process_utils.py:191} INFO - Using cached tzdata-2024.1-py2.py3-none-any.whl (345 kB)
[2024-07-31T17:51:57.322+0900] {process_utils.py:191} INFO - Using cached urllib3-2.2.2-py3-none-any.whl (121 kB)
[2024-07-31T17:51:57.324+0900] {process_utils.py:191} INFO - Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
[2024-07-31T17:51:57.366+0900] {process_utils.py:191} INFO - Building wheels for collected packages: mov
[2024-07-31T17:51:57.379+0900] {process_utils.py:191} INFO -   Building wheel for mov (pyproject.toml): started
[2024-07-31T17:51:57.516+0900] {process_utils.py:191} INFO -   Building wheel for mov (pyproject.toml): finished with status 'done'
[2024-07-31T17:51:57.516+0900] {process_utils.py:191} INFO -   Created wheel for mov: filename=mov-0.1.0-py3-none-any.whl size=3042 sha256=ec127ee681bb1d67d11fcac9800c244d7b8ec53cb192eb27e7d0f9db8a0eb231
[2024-07-31T17:51:57.517+0900] {process_utils.py:191} INFO -   Stored in directory: /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-ephem-wheel-cache-gn3y5q1c/wheels/cf/ab/a7/d0c528d20fa8a5f19e169bdf1d98f2b2cefe79d8527bb89200
[2024-07-31T17:51:57.518+0900] {process_utils.py:191} INFO - Successfully built mov
[2024-07-31T17:51:57.545+0900] {process_utils.py:191} INFO - Installing collected packages: pytz, urllib3, tzdata, six, numpy, idna, charset-normalizer, certifi, requests, python-dateutil, pyarrow, pandas, mov
[2024-07-31T17:52:02.108+0900] {process_utils.py:191} INFO - Successfully installed certifi-2024.7.4 charset-normalizer-3.3.2 idna-3.7 mov-0.1.0 numpy-2.0.1 pandas-2.2.2 pyarrow-17.0.0 python-dateutil-2.9.0.post0 pytz-2024.1 requests-2.32.3 six-1.16.0 tzdata-2024.1 urllib3-2.2.2
[2024-07-31T17:52:02.111+0900] {process_utils.py:191} INFO - 
[2024-07-31T17:52:02.111+0900] {process_utils.py:191} INFO - [notice] A new release of pip is available: 24.1.2 -> 24.2
[2024-07-31T17:52:02.111+0900] {process_utils.py:191} INFO - [notice] To update, run: python -m pip install --upgrade pip
[2024-07-31T17:52:02.256+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
[2024-07-31T17:52:02.257+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
[2024-07-31T17:52:02.257+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
[2024-07-31T17:52:02.257+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
[2024-07-31T17:52:02.258+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
[2024-07-31T17:52:02.258+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
[2024-07-31T17:52:02.259+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
[2024-07-31T17:52:02.259+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
[2024-07-31T17:52:02.263+0900] {process_utils.py:183} INFO - Executing cmd: /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/bin/python /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/script.py /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/script.in /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/script.out /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/string_args.txt /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/termination.log
[2024-07-31T17:52:02.265+0900] {process_utils.py:187} INFO - Output:
[2024-07-31T17:52:16.684+0900] {process_utils.py:191} INFO - {'boxOfficeResult': {'boxofficeType': '일별 박스오피스', 'showRange': '20120101~20120101', 'dailyBoxOfficeList': [{'rnum': '1', 'rank': '1', 'rankInten': '0', 'rankOldAndNew': 'OLD', 'movieCd': '20110295', 'movieNm': '마이 웨이', 'openDt': '2011-12-21', 'salesAmt': '1189058500', 'salesShare': '54.4', 'salesInten': '-105894500', 'salesChange': '-8.2', 'salesAcc': '13002897500', 'audiCnt': '153501', 'audiInten': '-16465', 'audiChange': '-9.7', 'audiAcc': '1739543', 'scrnCnt': '588', 'showCnt': '2321'}, {'rnum': '2', 'rank': '2', 'rankInten': '0', 'rankOldAndNew': 'OLD', 'movieCd': '20113260', 'movieNm': '퍼펙트 게임', 'openDt': '2011-12-21', 'salesAmt': '644532000', 'salesShare': '29.5', 'salesInten': '-75116500', 'salesChange': '-10.4', 'salesAcc': '6640940000', 'audiCnt': '83644', 'audiInten': '-12225', 'audiChange': '-12.8', 'audiAcc': '895416', 'scrnCnt': '396', 'showCnt': '1364'}, {'rnum': '3', 'rank': '3', 'rankInten': '0', 'rankOldAndNew': 'OLD', 'movieCd': '20113381', 'movieNm': '오싹한 연애', 'openDt': '2011-12-01', 'salesAmt': '344871000', 'salesShare': '15.8', 'salesInten': '-107005500', 'salesChange': '-23.7', 'salesAcc': '20634684500', 'audiCnt': '45062', 'audiInten': '-15926', 'audiChange': '-26.1', 'audiAcc': '2823060', 'scrnCnt': '243', 'showCnt': '839'}, {'rnum': '4', 'rank': '4', 'rankInten': '0', 'rankOldAndNew': 'OLD', 'movieCd': '20119659', 'movieNm': '량강도 아이들', 'openDt': '2011-11-17', 'salesAmt': '2139500', 'salesShare': '0.1', 'salesInten': '110500', 'salesChange': '5.4', 'salesAcc': '68282500', 'audiCnt': '271', 'audiInten': '4', 'audiChange': '1.5', 'audiAcc': '10172', 'scrnCnt': '11', 'showCnt': '35'}, {'rnum': '5', 'rank': '5', 'rankInten': '0', 'rankOldAndNew': 'NEW', 'movieCd': '20101344', 'movieNm': '파수꾼', 'openDt': '2011-03-03', 'salesAmt': '1015000', 'salesShare': '0.0', 'salesInten': '1015000', 'salesChange': '100', 'salesAcc': '170888700', 'audiCnt': '127', 'audiInten': '127', 'audiChange': '100', 'audiAcc': '22112', 'scrnCnt': '1', 'showCnt': '1'}, {'rnum': '6', 'rank': '6', 'rankInten': '0', 'rankOldAndNew': 'NEW', 'movieCd': '20113743', 'movieNm': '댄싱퀸', 'openDt': '2012-01-18', 'salesAmt': '1008000', 'salesShare': '0.0', 'salesInten': '1008000', 'salesChange': '100', 'salesAcc': '1008000', 'audiCnt': '126', 'audiInten': '126', 'audiChange': '100', 'audiAcc': '126', 'scrnCnt': '1', 'showCnt': '1'}, {'rnum': '7', 'rank': '7', 'rankInten': '0', 'rankOldAndNew': 'NEW', 'movieCd': '20110985', 'movieNm': '줄탁동시', 'openDt': '2012-03-01', 'salesAmt': '864000', 'salesShare': '0.0', 'salesInten': '864000', 'salesChange': '100', 'salesAcc': '2047000', 'audiCnt': '108', 'audiInten': '108', 'audiChange': '100', 'audiAcc': '305', 'scrnCnt': '1', 'showCnt': '1'}, {'rnum': '8', 'rank': '8', 'rankInten': '3', 'rankOldAndNew': 'OLD', 'movieCd': '20119436', 'movieNm': '오래된 인력거', 'openDt': '2011-12-15', 'salesAmt': '546000', 'salesShare': '0.0', 'salesInten': '359000', 'salesChange': '192', 'salesAcc': '15047800', 'audiCnt': '104', 'audiInten': '65', 'audiChange': '166.7', 'audiAcc': '2272', 'scrnCnt': '3', 'showCnt': '5'}, {'rnum': '9', 'rank': '9', 'rankInten': '0', 'rankOldAndNew': 'NEW', 'movieCd': '20111031', 'movieNm': '돼지의 왕', 'openDt': '2011-11-03', 'salesAmt': '509000', 'salesShare': '0.0', 'salesInten': '509000', 'salesChange': '100', 'salesAcc': '144630300', 'audiCnt': '57', 'audiInten': '57', 'audiChange': '100', 'audiAcc': '18660', 'scrnCnt': '2', 'showCnt': '2'}, {'rnum': '10', 'rank': '10', 'rankInten': '-3', 'rankOldAndNew': 'OLD', 'movieCd': '20112695', 'movieNm': '완득이', 'openDt': '2011-10-20', 'salesAmt': '339000', 'salesShare': '0.0', 'salesInten': '-97000', 'salesChange': '-22.2', 'salesAcc': '38526500500', 'audiCnt': '54', 'audiInten': '-22', 'audiChange': '-28.9', 'audiAcc': '5309982', 'scrnCnt': '2', 'showCnt': '4'}]}}
[2024-07-31T17:52:16.686+0900] {process_utils.py:191} INFO - Traceback (most recent call last):
[2024-07-31T17:52:16.687+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/script.py", line 55, in <module>
[2024-07-31T17:52:16.688+0900] {process_utils.py:191} INFO -     res = get_data_with_params(*arg_dict["args"], **arg_dict["kwargs"])
[2024-07-31T17:52:16.689+0900] {process_utils.py:191} INFO -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-07-31T17:52:16.689+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-call5asqi7pv/script.py", line 23, in get_data_with_params
[2024-07-31T17:52:16.690+0900] {process_utils.py:191} INFO -     df = save2df(url_params=url_params)
[2024-07-31T17:52:16.691+0900] {process_utils.py:191} INFO -          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-07-31T17:52:16.692+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/lib/python3.11/site-packages/mov/api/call.py", line 40, in save2df
[2024-07-31T17:52:16.692+0900] {process_utils.py:191} INFO -     df.to_parquet('~/tmp/test_parquet', partition_cols=partition)
[2024-07-31T17:52:16.693+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/lib/python3.11/site-packages/pandas/util/_decorators.py", line 333, in wrapper
[2024-07-31T17:52:16.694+0900] {process_utils.py:191} INFO -     return func(*args, **kwargs)
[2024-07-31T17:52:16.695+0900] {process_utils.py:191} INFO -            ^^^^^^^^^^^^^^^^^^^^^
[2024-07-31T17:52:16.696+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/lib/python3.11/site-packages/pandas/core/frame.py", line 3113, in to_parquet
[2024-07-31T17:52:16.696+0900] {process_utils.py:191} INFO -     return to_parquet(
[2024-07-31T17:52:16.697+0900] {process_utils.py:191} INFO -            ^^^^^^^^^^^
[2024-07-31T17:52:16.698+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/lib/python3.11/site-packages/pandas/io/parquet.py", line 480, in to_parquet
[2024-07-31T17:52:16.698+0900] {process_utils.py:191} INFO -     impl.write(
[2024-07-31T17:52:16.699+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/lib/python3.11/site-packages/pandas/io/parquet.py", line 218, in write
[2024-07-31T17:52:16.699+0900] {process_utils.py:191} INFO -     self.api.parquet.write_to_dataset(
[2024-07-31T17:52:16.700+0900] {process_utils.py:191} INFO -   File "/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvschaa1_q/lib/python3.11/site-packages/pyarrow/parquet/core.py", line 2163, in write_to_dataset
[2024-07-31T17:52:16.700+0900] {process_utils.py:191} INFO -     part_schema = table.select(partition_cols).schema
[2024-07-31T17:52:16.701+0900] {process_utils.py:191} INFO -                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-07-31T17:52:16.701+0900] {process_utils.py:191} INFO -   File "pyarrow/table.pxi", line 4207, in pyarrow.lib.Table.select
[2024-07-31T17:52:16.702+0900] {process_utils.py:191} INFO -   File "pyarrow/table.pxi", line 1668, in pyarrow.lib._Tabular._ensure_integer_index
[2024-07-31T17:52:16.703+0900] {process_utils.py:191} INFO - KeyError: 'Field "repNationCd" does not exist in schema'
[2024-07-31T17:52:17.171+0900] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-31T17:52:17.175+0900] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 437, in execute
    return super().execute(context=serializable_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 759, in execute_callable
    result = self._execute_python_callable_in_subprocess(python_path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/operators/python.py", line 514, in _execute_python_callable_in_subprocess
    raise AirflowException(error_msg) from None
airflow.exceptions.AirflowException: Process returned non-zero exit status 1.
'Field "repNationCd" does not exist in schema'
[2024-07-31T17:52:17.178+0900] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=movie, task_id=nation.k, run_id=scheduled__2024-07-30T02:10:00+00:00, execution_date=20240730T021000, start_date=20240731T085152, end_date=20240731T085217
[2024-07-31T17:52:17.182+0900] {standard_task_runner.py:110} ERROR - Failed to execute job 896 for task nation.k (Process returned non-zero exit status 1.
'Field "repNationCd" does not exist in schema'; 24118)
[2024-07-31T17:52:17.202+0900] {local_task_job_runner.py:243} INFO - Task exited with return code 1
[2024-07-31T17:52:17.209+0900] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-31T17:52:17.209+0900] {local_task_job_runner.py:222} INFO - ::endgroup::

[2024-07-30T10:42:43.988+0900] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-30T10:42:44.001+0900] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: movie.get_data scheduled__2024-07-28T04:10:00+00:00 [queued]>
[2024-07-30T10:42:44.006+0900] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: movie.get_data scheduled__2024-07-28T04:10:00+00:00 [queued]>
[2024-07-30T10:42:44.007+0900] {taskinstance.py:2306} INFO - Starting attempt 9 of 10
[2024-07-30T10:42:44.012+0900] {taskinstance.py:2330} INFO - Executing <Task(PythonVirtualenvOperator): get_data> on 2024-07-28 04:10:00+00:00
[2024-07-30T10:42:44.015+0900] {standard_task_runner.py:64} INFO - Started process 5809 to run task
[2024-07-30T10:42:44.018+0900] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'movie', 'get_data', 'scheduled__2024-07-28T04:10:00+00:00', '--job-id', '633', '--raw', '--subdir', 'DAGS_FOLDER/movie.py', '--cfg-path', '/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/tmpmqn8rxsz']
[2024-07-30T10:42:44.019+0900] {standard_task_runner.py:91} INFO - Job 633: Subtask get_data
[2024-07-30T10:42:44.034+0900] {task_command.py:426} INFO - Running <TaskInstance: movie.get_data scheduled__2024-07-28T04:10:00+00:00 [running]> on host jeongui-MacBookPro.local
[2024-07-30T10:42:44.055+0900] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='movie' AIRFLOW_CTX_TASK_ID='get_data' AIRFLOW_CTX_EXECUTION_DATE='2024-07-28T04:10:00+00:00' AIRFLOW_CTX_TRY_NUMBER='9' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-28T04:10:00+00:00'
[2024-07-30T10:42:44.055+0900] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-30T10:42:44.061+0900] {baseoperator.py:400} WARNING - PythonVirtualenvOperator.execute cannot be called outside TaskInstance!
[2024-07-30T10:42:44.062+0900] {process_utils.py:183} INFO - Executing cmd: /Users/DE32/.pyenv/versions/3.11.9/envs/note/bin/python -m virtualenv /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs --python=python
[2024-07-30T10:42:44.064+0900] {process_utils.py:187} INFO - Output:
[2024-07-30T10:42:44.236+0900] {process_utils.py:191} INFO - created virtual environment CPython3.11.9.final.0-64 in 112ms
[2024-07-30T10:42:44.236+0900] {process_utils.py:191} INFO -   creator CPython3Posix(dest=/private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs, clear=False, no_vcs_ignore=False, global=False)
[2024-07-30T10:42:44.237+0900] {process_utils.py:191} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/Users/DE32/Library/Application Support/virtualenv)
[2024-07-30T10:42:44.237+0900] {process_utils.py:191} INFO -     added seed packages: pip==24.1, setuptools==70.1.0, wheel==0.43.0
[2024-07-30T10:42:44.237+0900] {process_utils.py:191} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2024-07-30T10:42:44.248+0900] {process_utils.py:183} INFO - Executing cmd: /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/bin/pip install -r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt
[2024-07-30T10:42:44.250+0900] {process_utils.py:187} INFO - Output:
[2024-07-30T10:42:45.066+0900] {process_utils.py:191} INFO - Collecting git+https://github.com/Jeonghoon2/movie@0.2/api (from -r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:45.066+0900] {process_utils.py:191} INFO -   Cloning https://github.com/Jeonghoon2/movie (to revision 0.2/api) to /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-req-build-chcagga6
[2024-07-30T10:42:45.077+0900] {process_utils.py:191} INFO -   Running command git clone --filter=blob:none --quiet https://github.com/Jeonghoon2/movie /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-req-build-chcagga6
[2024-07-30T10:42:47.323+0900] {process_utils.py:191} INFO -   Running command git checkout -b 0.2/api --track origin/0.2/api
[2024-07-30T10:42:48.087+0900] {process_utils.py:191} INFO -   Switched to a new branch '0.2/api'
[2024-07-30T10:42:48.087+0900] {process_utils.py:191} INFO -   branch '0.2/api' set up to track 'origin/0.2/api'.
[2024-07-30T10:42:48.088+0900] {process_utils.py:191} INFO -   Resolved https://github.com/Jeonghoon2/movie to commit aa2c3b4aa6dee3ca8a154c45b4457913b4be6ccd
[2024-07-30T10:42:48.106+0900] {process_utils.py:191} INFO -   Installing build dependencies: started
[2024-07-30T10:42:48.988+0900] {process_utils.py:191} INFO -   Installing build dependencies: finished with status 'done'
[2024-07-30T10:42:48.988+0900] {process_utils.py:191} INFO -   Getting requirements to build wheel: started
[2024-07-30T10:42:49.112+0900] {process_utils.py:191} INFO -   Getting requirements to build wheel: finished with status 'done'
[2024-07-30T10:42:49.113+0900] {process_utils.py:191} INFO -   Preparing metadata (pyproject.toml): started
[2024-07-30T10:42:49.236+0900] {process_utils.py:191} INFO -   Preparing metadata (pyproject.toml): finished with status 'done'
[2024-07-30T10:42:49.295+0900] {process_utils.py:191} INFO - Collecting requests>=2.32.3 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.296+0900] {process_utils.py:191} INFO -   Using cached requests-2.32.3-py3-none-any.whl.metadata (4.6 kB)
[2024-07-30T10:42:49.363+0900] {process_utils.py:191} INFO - Collecting pandas>=2.2.2 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.364+0900] {process_utils.py:191} INFO -   Using cached pandas-2.2.2-cp311-cp311-macosx_11_0_arm64.whl.metadata (19 kB)
[2024-07-30T10:42:49.472+0900] {process_utils.py:191} INFO - Collecting numpy>=2.0.1 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.473+0900] {process_utils.py:191} INFO -   Using cached numpy-2.0.1-cp311-cp311-macosx_14_0_arm64.whl.metadata (60 kB)
[2024-07-30T10:42:49.676+0900] {process_utils.py:191} INFO - Collecting pyarrow>=17.0.0 (from mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.677+0900] {process_utils.py:191} INFO -   Using cached pyarrow-17.0.0-cp311-cp311-macosx_11_0_arm64.whl.metadata (3.3 kB)
[2024-07-30T10:42:49.703+0900] {process_utils.py:191} INFO - Collecting python-dateutil>=2.8.2 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.704+0900] {process_utils.py:191} INFO -   Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)
[2024-07-30T10:42:49.747+0900] {process_utils.py:191} INFO - Collecting pytz>=2020.1 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.748+0900] {process_utils.py:191} INFO -   Using cached pytz-2024.1-py2.py3-none-any.whl.metadata (22 kB)
[2024-07-30T10:42:49.769+0900] {process_utils.py:191} INFO - Collecting tzdata>=2022.7 (from pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.770+0900] {process_utils.py:191} INFO -   Using cached tzdata-2024.1-py2.py3-none-any.whl.metadata (1.4 kB)
[2024-07-30T10:42:49.814+0900] {process_utils.py:191} INFO - Collecting charset-normalizer<4,>=2 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.815+0900] {process_utils.py:191} INFO -   Using cached charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl.metadata (33 kB)
[2024-07-30T10:42:49.902+0900] {process_utils.py:191} INFO - Collecting idna<4,>=2.5 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.904+0900] {process_utils.py:191} INFO -   Using cached idna-3.7-py3-none-any.whl.metadata (9.9 kB)
[2024-07-30T10:42:49.940+0900] {process_utils.py:191} INFO - Collecting urllib3<3,>=1.21.1 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:49.941+0900] {process_utils.py:191} INFO -   Using cached urllib3-2.2.2-py3-none-any.whl.metadata (6.4 kB)
[2024-07-30T10:42:50.013+0900] {process_utils.py:191} INFO - Collecting certifi>=2017.4.17 (from requests>=2.32.3->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:50.014+0900] {process_utils.py:191} INFO -   Using cached certifi-2024.7.4-py3-none-any.whl.metadata (2.2 kB)
[2024-07-30T10:42:50.042+0900] {process_utils.py:191} INFO - Collecting six>=1.5 (from python-dateutil>=2.8.2->pandas>=2.2.2->mov==0.1.0->-r /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/requirements.txt (line 1))
[2024-07-30T10:42:50.043+0900] {process_utils.py:191} INFO -   Using cached six-1.16.0-py2.py3-none-any.whl.metadata (1.8 kB)
[2024-07-30T10:42:50.047+0900] {process_utils.py:191} INFO - Using cached numpy-2.0.1-cp311-cp311-macosx_14_0_arm64.whl (5.3 MB)
[2024-07-30T10:42:50.054+0900] {process_utils.py:191} INFO - Using cached pandas-2.2.2-cp311-cp311-macosx_11_0_arm64.whl (11.3 MB)
[2024-07-30T10:42:50.069+0900] {process_utils.py:191} INFO - Using cached pyarrow-17.0.0-cp311-cp311-macosx_11_0_arm64.whl (27.2 MB)
[2024-07-30T10:42:50.098+0900] {process_utils.py:191} INFO - Using cached requests-2.32.3-py3-none-any.whl (64 kB)
[2024-07-30T10:42:50.099+0900] {process_utils.py:191} INFO - Using cached certifi-2024.7.4-py3-none-any.whl (162 kB)
[2024-07-30T10:42:50.101+0900] {process_utils.py:191} INFO - Using cached charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl (118 kB)
[2024-07-30T10:42:50.103+0900] {process_utils.py:191} INFO - Using cached idna-3.7-py3-none-any.whl (66 kB)
[2024-07-30T10:42:50.104+0900] {process_utils.py:191} INFO - Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
[2024-07-30T10:42:50.105+0900] {process_utils.py:191} INFO - Using cached pytz-2024.1-py2.py3-none-any.whl (505 kB)
[2024-07-30T10:42:50.106+0900] {process_utils.py:191} INFO - Using cached tzdata-2024.1-py2.py3-none-any.whl (345 kB)
[2024-07-30T10:42:50.108+0900] {process_utils.py:191} INFO - Using cached urllib3-2.2.2-py3-none-any.whl (121 kB)
[2024-07-30T10:42:50.109+0900] {process_utils.py:191} INFO - Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
[2024-07-30T10:42:50.151+0900] {process_utils.py:191} INFO - Building wheels for collected packages: mov
[2024-07-30T10:42:50.165+0900] {process_utils.py:191} INFO -   Building wheel for mov (pyproject.toml): started
[2024-07-30T10:42:50.300+0900] {process_utils.py:191} INFO -   Building wheel for mov (pyproject.toml): finished with status 'done'
[2024-07-30T10:42:50.301+0900] {process_utils.py:191} INFO -   Created wheel for mov: filename=mov-0.1.0-py3-none-any.whl size=2814 sha256=e439b8e8f3801c805452c8ed0d8db4161006093847fe4fb3a366cf4bf3933fed
[2024-07-30T10:42:50.301+0900] {process_utils.py:191} INFO -   Stored in directory: /private/var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/pip-ephem-wheel-cache-ifacpur6/wheels/54/e9/60/a7e5fa402215fa867148cc88ae8743f86bf8c78aace52a42fa
[2024-07-30T10:42:50.302+0900] {process_utils.py:191} INFO - Successfully built mov
[2024-07-30T10:42:50.330+0900] {process_utils.py:191} INFO - Installing collected packages: pytz, urllib3, tzdata, six, numpy, idna, charset-normalizer, certifi, requests, python-dateutil, pyarrow, pandas, mov
[2024-07-30T10:42:54.837+0900] {process_utils.py:191} INFO - Successfully installed certifi-2024.7.4 charset-normalizer-3.3.2 idna-3.7 mov-0.1.0 numpy-2.0.1 pandas-2.2.2 pyarrow-17.0.0 python-dateutil-2.9.0.post0 pytz-2024.1 requests-2.32.3 six-1.16.0 tzdata-2024.1 urllib3-2.2.2
[2024-07-30T10:42:54.851+0900] {process_utils.py:191} INFO - 
[2024-07-30T10:42:54.851+0900] {process_utils.py:191} INFO - [notice] A new release of pip is available: 24.1 -> 24.2
[2024-07-30T10:42:54.852+0900] {process_utils.py:191} INFO - [notice] To update, run: python -m pip install --upgrade pip
[2024-07-30T10:42:54.999+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
[2024-07-30T10:42:55.000+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
[2024-07-30T10:42:55.000+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
[2024-07-30T10:42:55.001+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
[2024-07-30T10:42:55.001+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
[2024-07-30T10:42:55.001+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
[2024-07-30T10:42:55.002+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
[2024-07-30T10:42:55.002+0900] {logging_mixin.py:188} WARNING - /Users/DE32/.pyenv/versions/3.11.9/envs/note/lib/python3.11/site-packages/airflow/utils/context.py:212 AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
[2024-07-30T10:42:55.005+0900] {process_utils.py:183} INFO - Executing cmd: /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venvuipm3vbs/bin/python /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callu2uzj38s/script.py /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callu2uzj38s/script.in /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callu2uzj38s/script.out /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callu2uzj38s/string_args.txt /var/folders/qv/0knwm5h50ml0skpppwpbks_r0000gp/T/venv-callu2uzj38s/termination.log
[2024-07-30T10:42:55.007+0900] {process_utils.py:187} INFO - Output:
[2024-07-30T10:43:10.199+0900] {process_utils.py:191} INFO - ====================
[2024-07-30T10:43:10.200+0900] {process_utils.py:191} INFO - MOVIE_API_KEY = 6158692ade44de1857753bae9741d704
[2024-07-30T10:43:10.200+0900] {process_utils.py:191} INFO -   rnum rank rankInten rankOldAndNew  ...  audiAcc scrnCnt showCnt   load_dt
[2024-07-30T10:43:10.200+0900] {process_utils.py:191} INFO - 0    1    1         0           OLD  ...  5328435     697    3223  20120101
[2024-07-30T10:43:10.201+0900] {process_utils.py:191} INFO - 1    2    2         1           OLD  ...  1739543     588    2321  20120101
[2024-07-30T10:43:10.201+0900] {process_utils.py:191} INFO - 2    3    3        -1           OLD  ...  1442861     360    1832  20120101
[2024-07-30T10:43:10.201+0900] {process_utils.py:191} INFO - 3    4    4         0           OLD  ...   895416     396    1364  20120101
[2024-07-30T10:43:10.202+0900] {process_utils.py:191} INFO - 4    5    5         0           OLD  ...   202909     290     838  20120101
[2024-07-30T10:43:10.202+0900] {process_utils.py:191} INFO - 
[2024-07-30T10:43:10.202+0900] {process_utils.py:191} INFO - [5 rows x 19 columns]
[2024-07-30T10:43:10.202+0900] {process_utils.py:191} INFO - ====================
[2024-07-30T10:43:10.203+0900] {process_utils.py:191} INFO -   rnum rank rankInten rankOldAndNew  ...  audiAcc scrnCnt showCnt   load_dt
[2024-07-30T10:43:10.203+0900] {process_utils.py:191} INFO - 0    1    1         0           OLD  ...  5328435     697    3223  20120101
[2024-07-30T10:43:10.203+0900] {process_utils.py:191} INFO - 1    2    2         1           OLD  ...  1739543     588    2321  20120101
[2024-07-30T10:43:10.203+0900] {process_utils.py:191} INFO - 2    3    3        -1           OLD  ...  1442861     360    1832  20120101
[2024-07-30T10:43:10.204+0900] {process_utils.py:191} INFO - 3    4    4         0           OLD  ...   895416     396    1364  20120101
[2024-07-30T10:43:10.204+0900] {process_utils.py:191} INFO - 4    5    5         0           OLD  ...   202909     290     838  20120101
[2024-07-30T10:43:10.204+0900] {process_utils.py:191} INFO - 
[2024-07-30T10:43:10.204+0900] {process_utils.py:191} INFO - [5 rows x 19 columns]
[2024-07-30T10:43:10.629+0900] {python.py:237} INFO - Done. Returned value was: None
[2024-07-30T10:43:10.629+0900] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-30T10:43:10.633+0900] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=movie, task_id=get_data, run_id=scheduled__2024-07-28T04:10:00+00:00, execution_date=20240728T041000, start_date=20240730T014244, end_date=20240730T014310
[2024-07-30T10:43:10.676+0900] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-30T10:43:10.684+0900] {taskinstance.py:3503} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-07-30T10:43:10.685+0900] {local_task_job_runner.py:222} INFO - ::endgroup::
